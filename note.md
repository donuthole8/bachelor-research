# メモ

光沢情報等からR,G,Bを用いて近赤外線情報を取得できない？？



### 研究背景

- ドローンは災害箇所が判明してから飛ばして詳細な情報を得る
- よって災害早期に飛ばせる代物ではない可能性は高い
- これをどうにか災害早期にドローンを飛ばす理由を見つけるか、災害数日後画像にて災害個所を特定する研究に鞍替えを行う必要がある
- ドローンの利点
  - 被災地の状況を映像にてリアルタイム伝達
  - 被害状況を幅広く俯瞰し多くの情報を得る
  - ヘリテレよりも低空飛行が可能であり詳細な情報、ヘリが飛行不可能な箇所の飛行が可能
  - ヘリテレよりも準備時間・コストが少なく迅速に情報収集・救助が可能
  - 救助者のリスクを抑えることが可能
  - 災害箇所・崩壊家屋の特定
  - 風に強い
  - 地方自治体でも配備しやすい
  - 
- ドローンの欠点
  - 飛行時間が短い
  - 操縦者が近くにいる必要がある
  - 既に災害箇所が判明している
  - 墜落等の二次災害につながる可能性がある
- 超詳細情報得られる
  - →→人物特定に役立つ？？
  - 院進後の研究で被災後の人物抽出とか
  - 著作権は非常に面倒である

- 衛星＋空撮はヘリくらいでないと位置合わせで死ぬ
- 前後フレームがあるのは強みなので位置合わせできるようなランドマークが出るまでフレーム進行してみて位置合わせとか
  - 特徴的な建物（青い屋根とか小学校）はあるにはあるので本物の山間部以外でならできるかも
  - これができれば浸水領域と河川領域を分類できるッ
  - 射影変換では空が邪魔なので空の高さまで画像をトリミング、その後射影変換
  - それか剛体変形みたいなやつ
- オルソ画像を作って位置合わせとか
- ドローンが撮影開始するまでどれくらいかかるか訊かれたけど救急隊員がドローン持ってれば即時
- 関東・東北豪雨での鬼怒川破堤後4時間で撮影開始（国土地理院）
- 北海道台風9号11号では北海道台風消滅後10時間



### 精度評価

- 正解画像を目視で着色作成して出力画像と比較？



### ドローンについて

- UAV(unhumanned a vehicle)





### 最も高精度な処理手順
 - ミーンシフト〈PyMeanShift〉
 - 輝度値補正
 - テクスチャ解析
 - 空・植生領域除去





### Github使い方





### 領域分類

- 領域分類というよりは空・植生領域除去

- 基本的にL\*a\*b\*表色系を使用

- HSV表色系・L\*C\*h\*表色系・RGB表色系も使用したい
  - 彩度を十分強くし、RGB表色系によって領域分類するのもいいかも
    - RGBの傾向は強くなったがあまり良い精度ではなかった
  
- VARI (Visible Atmospherically Resistant Index) を併用する
  - 赤が濃いほど VARI 値が高く、緑が濃いほど VARI 値が低い
  - 可視大気抵抗指数 (VARI) は、日照の違いや大気の影響を軽減しながら、スペクトルの可視部分で植生を強調
  - 人工物か植生かどうかといった判別には向いていない点、また、同じ場所であっても他の時期に撮影した色味の異なる写真など、複数時期の VARI の出力値の単純な比較は難しい
  
- B成分最小画素を土砂候補で検出

- 空領域は抜群に輝度が高い（ほぼ最大値）
  
  - b\*と組み合わせれば高精度で抽出可能か
  
- 特徴量で植生判別可能か
  - エッジ・異質度
  - 異質度低且つa\*値低である画素を植生領域
  - 異質度高且つb\*値低である画素を空領域
  - 植生・空をまとめて除去
  
- 植生領域は小領域が複数集合している

- 空領域は雲を除けば大領域であることが多い

- テクスチャで植生を

- ミーンシフトのときに小領域が潰れて消えるのは問題




### 人工物除去

- 建物領域はエッジ・異質度・テクスチャ等でなんとか除去できるかもしれない
- 屋根領域は均一な形であるので特徴量では難しそう
  - さらに屋根は青色や茶色、赤色等があるので色相での除去も難しそう
- 屋根の形（長方形・直線的等）の特徴を取れれば検出可能か
  - hough変換
  - https://data-analysis-stats.jp/python/%E3%83%8F%E3%83%95%E5%A4%89%E6%8F%9B%E3%81%A8lsd%E3%81%AB%E3%82%88%E3%82%8B%E7%9B%B4%E7%B7%9A%E6%A4%9C%E5%87%BA%E3%81%AE%E6%AF%94%E8%BC%83/



- 佐治てんてーの論文より

  - 土領域の検出

    土領域の検出においても、式(1)に示す比演算を用いる。土領域内の画素では、RGBの中でRの輝度値が強くなる傾向があると考えられるため、各画素において式(1)を用いて(α,β)=(R,G)、(α,β)=(R,B)として、それぞれの比演算を行う。そして、2.3.1項における森林領域の検出と同様にして、Rの輝度値が強く表れる箇所を土領域として検出する。なお、ここでの閾値は、前者で0.005、後者で0.05とする。

  - 瓦礫領域の検出

    瓦礫領域は、エッジ角度の分散値を利用して検出する。ここでの瓦礫領域とは、瓦礫や石などが散乱している領域を意味する。このような領域では、エッジ角度にばらつきが生じており、その分散値は高くなると考えられる。よって、エッジ角度の分散値が高いという条件で瓦礫領域を検出する。ここでの計算では、各画素を中心とした局所領域内のエッジ角度の出現数を求め、それを注目画素における分散値とする。ここで、エッジ角度はKirschのエッジ検出オペレータにより求め、局所領域のサイズは7画素×7画素とし、分散値（出現数）の閾値は6種類とする。なお、瓦礫領域と同様のテクスチャをした森林領域においても、その分散値は高くなると考えられるために誤検出が生じる可能性が高い。そこで、2.3.1項で検出された森林領域の情報を用いて、森林領域に分類されていない領域に限定して、分散値の高い画素を瓦礫領域として検出する。 

- 山口さんの論文（高解像度衛星画像を用いた地震被災地解析）より

  - 従来手法での瓦礫領域抽出
    - 色情報
      - RGBの内Rの値が高い
      - RGB各色の分散値が高い
    - エッジ情報
      - 短いエッジが複数の向きで存在
        - エッジの角度について分散値が高い
  - 津波被害地の瓦礫は
    - 色情報
      - RGBの内Bの値が高いものやRの値の低いものも存在
        - ドローン映像はどうだろう？？
  - 瓦礫の特徴量
    - N×Nのフィルタ内に微小領域が複数存在
      - 領域分割結果より判別
    - RGBの色調が分散している
      - N×Nのフィルタ内に色調濃度が広く分布
      - 色調の頻度が一定値以下
      - 色調の濃度が広く分布
      - 双峰性の山をもつことが多くある画素値の頻度が高い
      - RGB各調の濃度の標準偏差値
      - 各色調頻度の標準偏差値
        - 累乗関数として表すことが可能



- 機械学習のデータセットで弾くのもあり



### 斜面崩壊・浸水判別

- 浸水領域

  - 輝度値の利用はほぼ必須と思う
  - 黄色成分多め？
  - 均一度高めと思ったがそんなことはなかった
  - 前後フレームでなだらかな水流がある箇所とか

- 斜面崩壊領域

- 斜面崩壊と浸水判別はコーナー検出でもありかも

  



### フィードバック

- 土砂は黄色もああるからb値も使ったり、植生にb値を使ったり、Lをなんとか使ったりとLabをフルで使用する

- それぞれの領域の判断条件をもっと増やすといい

- 土砂は赤いだけでなく黄色いし、若葉があると緑っぽくなることも

- 土砂災害直後ならばあまり意味がない（ドローンは場所がわかったあとで飛ばすので）

- 「 車載カメラ映像による風景特徴解析技術」を参考にして

- 災害からの時間で精度が変わるなら、災害早期把握のように期間を区切ったほうがいい

- 30分以内ならヘリの方がいいなど、撮影時刻により精度が変わることがある

- ドローンで撮影してる時点でどこで災害が起こってるかわかってる





### 10/12フィードバック

- 研究背景をとにかく詰められる
- 背景・ドローン映像の弱点・強味はよく考えておいたほうが良い
- FIJIをうまく使用して効率よく閾値を手動設定
- テクスチャ特徴
- DEMデータと空撮画像の位置合わせは非常に難しい
- 位置合わせをするならQGISを用いるとよい
- 衛星画像を併用すると位置合わせがしやすい
- 「浸水領域」とはもともと人の生活圏で災害により浸水した箇所のことを言うので地図等との位置合わせによって道路や畑、建物等→水となった領域を見つける必要がある
- 空・植生除去するよりもいきなり斜面崩壊・浸水領域を出しちゃってもいいかも
- 浸水領域検出のために「土砂水検出」とかでも研究になる（院に行ってから着手するとか）



### 10/15フィードバック

- 動画像の利点（フレーム進行）によって誤検出減少
- 紹介した論文の手法でやってみる
- 複雑度と
- 屋根は直線検出と長方形検出みたいなので検出







